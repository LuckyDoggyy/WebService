<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link type="text/css" href="lib/jquery-ui-1.8.4.custom/css/smoothness/jquery-ui-1.8.4.custom.css" rel="stylesheet" />
<script type="text/javascript" src="lib/raphael-min.js"></script>
<script type="text/javascript" src="lib/jquery-ui-1.8.4.custom/js/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="lib/jquery-ui-1.8.4.custom/js/jquery-ui-1.8.4.custom.min.js"></script>
<script type="text/javascript" src="myflow.js"></script>
<script type="text/javascript" src="myflow.jpdl3.js"></script>
<script type="text/javascript" src="myflow.editors.js"></script>
<script type="text/javascript">

		function add(obj){
            $(obj).parent('td').parent('tr').after('<tr><td><input></td><td><input type="button" value="增加" onclick="add(this)"></td><td><input type="button" value="删除" onclick="remove(this)"></td></tr>');
        };

         function remove(obj){
            $(obj).parent('td').parent('tr').remove();
        };

	$(function() {
		$('#myflow')
				.myflow(
						{
							basePath : "",
							restore : eval("({states:" +
								"{rect1:{type:'start',text:{text:'开始'}, attr:{ x:366, y:12, width:101, height:50}, props:{text:{value:'开始'}}}," +
								"rect2:{type:'receive',text:{text:'接收'}, attr:{ x:363, y:91, width:100, height:50}, props:{text:{value:'接收'},desc:{value:'接受流程输入'},input:{value:':'}}}," +
								"rect3:{type:'invoke',text:{text:'service1'}, attr:{ x:286, y:376, width:103, height:50}, props:{id:{value:''},text:{value:'service1'},desc:{value:''},input:{value:'phone number:11111'},output:{value:'city1:shanghai,city2:beijing'}}}," +
								"rect4:{type:'reply',text:{text:'返回'}, attr:{ x:364, y:643, width:100, height:50}, props:{text:{value:'返回'},desc:{value:'返回流程结果'},output:{value:''}}}," +
								"rect5:{type:'end',text:{text:'结束'}, attr:{ x:362, y:727, width:103, height:50}, props:{text:{value:'结束'}}}," +
								"rect6:{type:'if',text:{text:'判断'}, attr:{ x:364, y:279, width:100, height:50}, props:{text:{value:'判断'},desc:{value:'根据条件判断'},input:{value:'param:value'},judge:{value:'if(param satisfy condition) choose path'}}}," +
								"rect7:{type:'invoke',text:{text:'service2'}, attr:{ x:457, y:372, width:100, height:50}, props:{id:{value:''},text:{value:'service2'},desc:{value:''},input:{value:':'},output:{value:':'}}}," +
								"rect15:{type:'assign',text:{text:'ifnode'}, attr:{ x:367, y:474, width:100, height:50}, props:{text:{value:''},desc:{value:'if result'},judge:{value:''}}}," +
								"rect16:{type:'assign',text:{text:'whilenode'}, attr:{ x:369, y:555, width:100, height:50}, props:{text:{value:''},desc:{value:'while result'},judge:{value:''}}}," +
								"rect17:{type:'while',text:{text:'循环'}, attr:{ x:363, y:180, width:100, height:50}, props:{text:{value:''},desc:{value:'循环'},judge:{value:''}}}}," +
								"paths:{" +
								"path8:{from:'rect1',to:'rect2', dots:[],text:{text:'TO 接收'},textPos:{x:37,y:-4}, props:{text:{value:''}}}," +
								"path10:{from:'rect4',to:'rect5', dots:[],text:{text:'TO 结束'},textPos:{x:33,y:-3}, props:{text:{value:''}}}," +
								"path12:{from:'rect6',to:'rect7', dots:[],text:{text:'TO 结束'},textPos:{x:0,y:-10}, props:{text:{value:''}}}," +
								"path14:{from:'rect6',to:'rect3', dots:[],text:{text:'TO 调用'},textPos:{x:0,y:-10}, props:{text:{value:''}}}," +
								"path18:{from:'rect3',to:'rect15', dots:[],text:{text:'TO ifnode'},textPos:{x:0,y:-10}, props:{text:{value:''}}}," +
								"path19:{from:'rect7',to:'rect15', dots:[],text:{text:'TO ifnode'},textPos:{x:0,y:-10}, props:{text:{value:''}}}," +
								"path20:{from:'rect15',to:'rect16', dots:[],text:{text:'TO whilenode'},textPos:{x:0,y:-10}, props:{text:{value:''}}}," +
								"path21:{from:'rect16',to:'rect4', dots:[],text:{text:'TO 返回'},textPos:{x:0,y:-10}, props:{text:{value:''}}}," +
								"path22:{from:'rect16',to:'rect17', dots:[{x:646,y:580},{x:643,y:204}],text:{text:'TO 循环'},textPos:{x:0,y:-10}, props:{text:{value:'TO 循环'}}}," +
								"path23:{from:'rect17',to:'rect6', dots:[],text:{text:'TO 判断'},textPos:{x:0,y:-10}, props:{text:{value:''}}}," +
								"path24:{from:'rect2',to:'rect17', dots:[],text:{text:'TO 循环'},textPos:{x:0,y:-10}, props:{text:{value:''}}}}," +
								"props:" +
								"{props:{name:{value:'新建流程'},flowid:{value:''},desc:{value:''}}}})"),

							tools : {
								save : {
									onclick : function(data) {
									    console.log(data);
									}
								}
							}
						});





	});
</script>
<style type="text/css">
body {
	margin: 0;
	pading: 0;
	text-align: left;
	font-family: Arial, sans-serif, Helvetica, Tahoma;
	font-size: 12px;
	line-height: 1.5;
	color: black;
	background-image: url(img/bg.png);
}

.node {
	width: 70px;
	text-align: center;
	vertical-align: middle;
	border: 1px solid #fff;
}

.mover {
	border: 1px solid #ddd;
	background-color: #ddd;
}

.selected {
	background-color: #ddd;
}

.state {
	
}

#myflow_props table {
	
}

#myflow_props th {
	letter-spacing: 2px;
	text-align: left;
	padding: 6px;
	background: #ddd;
}

#myflow_props td {
	background: #fff;
	padding: 6px;
}

#pointer {
	background-repeat: no-repeat;
	background-position: center;
}

#path {
	background-repeat: no-repeat;
	background-position: center;
}

#task {
	background-repeat: no-repeat;
	background-position: center;
}

#state {
	background-repeat: no-repeat;
	background-position: center;
}
</style>
</head>
<body>
<div id="myflow_tools"
	style="position: absolute; top: 10; left: 10; background-color: #fff; width: 70px; cursor: default; padding: 3px;"
	class="ui-widget-content">
<div id="myflow_tools_handle" style="text-align: center;"
	class="ui-widget-header">工具集</div>


<div class="node" id="myflow_save"><img src="img/save.gif" />&nbsp;&nbsp;保存</div>
<div>
<hr />
</div>
<div class="node selectable" id="pointer"><img
	src="img/select16.gif" />&nbsp;&nbsp;选择</div>
<div class="node selectable" id="path"><img
	src="img/16/flow_sequence.png" />&nbsp;&nbsp;转换</div>
<div>
<hr />
</div>

	<!--type -->
	<div class="node state" id="start" type="start"><img
			src="img/16/startnode.gif" />&nbsp;&nbsp;开始</div>
	<div class="node state" id="empty" type="empty"><img
		src="img/16/empty.gif" />&nbsp;&nbsp;空操作</div>
	<div class="node state" id="invoke" type="invoke"><img
			src="img/16/invoke.gif" />&nbsp;&nbsp;调用</div>
	<div class="node state" id="receive" type="receive"><img
			src="img/16/receive.gif" />&nbsp;&nbsp;接收</div>
	<div class="node state" id="reply" type="reply"><img
			src="img/16/reply.gif" />&nbsp;&nbsp;返回</div>
	<div class="node state" id="end" type="end"><img
			src="img/16/endnode.gif" />&nbsp;&nbsp;结束</div>
	<hr />
<div class="node state" id="if" type="if"><img
	src="img/16/if.gif" />	判断</div>
<div class="node state" id="while" type="while"><img
	src="img/16/while.gif" />&nbsp;&nbsp;循环</div>
<div class="node state" id="flow" type="flow"><img
	src="img/16/flow.gif" />&nbsp;&nbsp;并行</div>
<div class="node state" id="assign" type="assign"><img
	src="img/16/assign.gif" />&nbsp;&nbsp;node</div>
<div class="node state" id="end-error" type="end-error"><img
	src="img/16/end_event_error.png" />&nbsp;&nbsp;错误</div>

</div>

<div id="myflow_props"	style="position: absolute; top: 30; right: 50; background-color: #fff; width: 320px; padding: 3px;"
	class="ui-widget-content">	<!-- 属性框 -->
<div id="myflow_props_handle" class="ui-widget-header">属性</div>
<table border="1" width="100%" cellpadding="0" cellspacing="0">
</table>
<div>&nbsp;</div>
</div>

<div id="myflow"></div>
</body>
</html>